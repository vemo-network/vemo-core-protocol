### Project Overview
Vemo is a protocol designed to tokenizing locked positions into dynamic NFTs with on-chain balances and release schedules, known as smart vouchers, revolutionizes the landscape of decentralized finance. Smart voucher holders enjoy the freedom to claim tokens in accordance with the preset release schedule, all without requiring external permission. Remarkably, the voucher market operates autonomously from the spot market, ensuring that trading vouchers has no impact on the spot price of the underlying token. This innovative approach fosters a decentralized ecosystem where locked positions are seamlessly transformed into tradable assets, unlocking new possibilities for liquidity provision and financial flexibility.

For version 1, the core framework of Vemo is built around three core contracts: VoucherFactory.sol, VoucherAccount.sol. The VoucherFactory contract functions as the manager of the Collection (nft) and token bound account, allowing user to not only create voucher collection but also represent as a portal to create VoucherAccount, the VoucherAccount contract is responsible for containing the token assets. Each VoucherAccount (token bound account) is linked 1:1 with a ERC721 token (nft), employing mechanisms that allows rewards to be claimed over a fixed period or linear hours/days/months. This implementation enables vesting position(s) trable thru the ERC721 ownership while maintaining the vesting logic.

Additionally, Vemo is designed to accommodate more locked positions from various sources ie Staking or can even adapt any business logic with the potential for future expansion which is planned in the version 2.

File Name | Description
-- | --
VoucherFactory.sol | The code defines a smart contract, VoucherFactory, responsible for managing the distribution of NFT token and token bound account (in the form of VoucherAccount) to managing the vestings positions. It also serves as a portal, enabling users to create NFT:VoucherAccount in batch, specify vesting schedule and requesting common information.
AccountRegistry.sol | The code defines AccountRegistry, a contract serving as the factory of the VoucherAccount, allowing for the creation and retrieval of token-bound accounts for non-fungible tokens (NFTs) using the CREATE2 opcode. This contract serves as a registry for token-bound accounts associated with NFTs, providing functions to create and retrieve these accounts in a deterministic manner
VoucherAccount.sol | The code defines VoucherAccount, a contract is designed to hold tokens asset on behalf of users while delegating the ownership to the NFT owner. The NFT owner can claim the vesting token thru the VoucherFactory or thru the VoucherAccount itself.
VemoVestingPoolFactory.sol | The code defines VemoVestingPoolFactory, a contract serves as a factory for creating and managing VemoVestingPool contracts, providing a standardized and efficient way to deploy and interact with token vesting schedules within decentralized applications.
VestingPool.sol | The code defines VestingPool, a contracts manages token vesting schedules and facilitating the purchase and distribution of tokens according to predefined rules. It incorporates features like whitelist verification, fee calculations, flexible allocation options.

### Diagram
1. Overview
![overview.png](https://i.postimg.cc/5yY8DT32/overview.png)

2. IVO flow
![sequence.png](https://www.planttext.com/api/plantuml/png/TLCnRiCm3Dpr2i9xF-2XI9UWGri4HT2fYo0HiM1R2YGwQNvVobPIoLP7du_7koEq2oGzJUCWf2BduUXwjAzkqEX11cZcRrY0Hg0bGpVuma36dWxE3Vjvx3Pp4mmHX_IZDhCX_v7Sf3hqXUW2RVKM_4KfDragg0bhKgIuuS0XZJ9dcQYpZGmCZH1vzAVdIiWMtfpguUoDvQa1WU94-BPNGnrSKg307aOKogCap5L4fRPoJmiVU8MYnaL6RzqLJRNmRZZPPG6hXa1QdLcNOwn8h0fduMmFszaVOMHbDd3FKzHUcIy9xVfEWx4zQcukQWknliswZqeiZS5ubi0VrKbxIbV8ouqgA-4YoZzTFYn_eaOS7zULnBsvCtFlZPBX0-_GQdutlm00)

3. create voucher flow
![sequence_1.png](https://www.planttext.com/api/plantuml/png/bP8nRy8m48Lt_ufJTiIUeG8XeGvj1uIOMApBKImSEzWNAlvzxH07nsfLTSppT_UUdxFoB1tthHOIsJhOsmkPLwiRSY0zLCCtF8HAa675TpZO7i_ajiF8VU162KQjHDU8jZSyGqTjGZTMQq9MrWpOntQVIPKGURJ5In6YXXrTU_Ayt3YIJ70RNN1Q8V1nybmgYek4hS_36jvLJ0pcnFcMFuF0cyKBT4uPL9qcu8Zxe_bIV8PRYAZC9_WmqjA_8xKnKhfQ22QoqWAQ9QiX5XXvQfBD_35-i9e3XPsSZwKdBMqBF4NujRV9R4SDKJlL9JbqQBl0fivOXSPMP9hmktu3)

### Sequence Diagram Overview
1. Token Holder: Initiator of token-related actions, including locking tokens in vesting schemes and minting vouchers.
2. Vesting Pool Factory: A contract that facilitates the creation of Vesting Pools with specific vesting schemes and terms.
3. Vesting Pool: Holds the principle tokens and defines the terms for pool participation.
4. VoucherFactory: A contract that mints vouchers and NFTs based on the input vesting scheme and principle amount.
5. VoucherAccount: An account or entity that represents the minted voucher linked to an NFT.
6. Pool Participants: Entities that can participate in vesting pools, offering exchange tokens to mint vouchers.


This sequence outlines the flow of tokens from initial locking to the redemption post-vesting, encompassing the minting of vouchers and NFTs, and the participation of pool participants in the vesting process.

#### Create voucher

- **createBatch**: Allows a user to batch mint voucher with principle tokens, multiple vesting schemes.
```
function createBatch(address tokenAddress, BatchVesting memory batch, uint96 royaltyRate) public nonReentrant returns (address, uint256, uint256) {}
```
- **create**: Allows a user to mint a voucher with principle tokens, multiple vesting schemes.
```
function create(address tokenAddress, Vesting memory vesting) external returns (address nftAddress, uint256 tokenId){}
```
#### Redeem voucher

- **VoucherFactory.redeem**: This function executes a vesting process for the voucher owner, with VoucherFactory acting as the portal.
```
function redeem(address nftAddress, uint256 tokenId, uint256 _amount) external returns (bool) {}
```
- **VoucherAccount.redeem**: This function performs the vesting process directly on the voucher account, as initiated by the voucher owner.
```
function redeem(uint256 amount) external{}
```

### Data structure
- **Voucher input structure**:
```
struct VestingSchedule {
    uint256 amount;
    uint8 vestingType; // linear: 1 | staged: 2
    uint8 linearType; // day: 1 | week: 2 | month: 3 | quarter: 4
    uint256 startTimestamp;
    uint256 endTimestamp;
    uint8 isVested; // unvested: 0 | vested : 1 | vesting : 2
    uint256 remainingAmount;
}

struct VestingFee {
    uint8 isFee; // no-fee: 0 | fee : 1
    address feeTokenAddress;
    address receiverAddress;
    uint256 totalFee;
    uint256 remainingFee;
}

struct Vesting {
    uint256 balance;
    VestingSchedule[] schedules;
    VestingFee fee;
}

struct BatchVesting {
    Vesting vesting;
    uint256 quantity;
    string[] tokenUris;
}
```
### Events
- **VoucherCreated**: Emitted when a voucher is created.
```
event VoucherCreated(
        address indexed account,
        address indexed currency,
        uint256 amount,
        address indexed nftCollection,
        uint256 tokenId
    );
```
- **Voucher aka Token bound account**: TBA is a comprehensive entity that encompasses the vesting schedule and locked tokens, in addition to implementing the business logic. Furthermore, each TBA is linked to an NFT featuring a structured metadata format
```
{
    name:	"Smart Voucher #0",
    description:	"smart voucher description",
    image:	"ipfs_link",
}
```

- **VoucherRedeem**: Signals when a partial or full amount of vesting tokens is claimed from the voucher.
```
 event VoucherRedeem(
        address indexed account,
        address indexed currency,
        uint256 claimedAmount,
        address indexed nftCollection,
        uint256 tokenId
    );
```

### Conclusion
