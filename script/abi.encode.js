const ethers = require('ethers');
const { Contract, JsonRpcProvider, Interface } = require('ethers')

let intf = new Interface(require('../out/VemoVestingPoolFactory.sol/VemoVestingPoolFactory.json').abi);

// console.log(
//     iface.format(FormatTypes.minimal)
// );

// console.log(
//     intf._decodeParams("CreateVestingPoolParams", "0x00000000000000000000000000000000000000000000000000000000000000203e5fbf41c817b48b460e2ac06aff826b4c160f3784d91be47ab02bceeeb5d7f900000000000000000000000000000000000000000000000000000000000001e000000000000000000000000019b8dd424bbee16f091628a415f58cbcd438c4290000000000000000000000000000000000000000000a7a2cba76fcaf571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c80000000000000000000000000000000000000000000000000000000000000280000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000380de2264740f2a2bb5caa89e915318adfa56703b198c9bffd7557ab495f9224d2e0000000000000000000000000000000000000000000000000000000066288363000000000000000000000000000000000000000000000000000000006631bc8700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000a7a2cba76fcaf5710000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006628830f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
// );

/**
 * struct CreateVestingPoolParams {
        bytes32 hashes;
        uint256 poolId;

        address token0;
        uint256 token0Amount;
        address token1;
        uint256 expectedToken1Amount;
        uint8 poolType;
        bool flexibleAllocation;
        uint256 maxAllocationPerWallet;
        uint96 royaltyRate; 9 

        IVoucher.VestingSchedule[] schedules; 10
        IVoucher.VestingFee fee; 11
        string baseUrl; 12
        bytes32 root; 13
        uint256 startAt;
        uint256 endAt;
    }
 */
let parameters = intf.decodeFunctionData('createVestingPool', "0x384be32500000000000000000000000000000000000000000000000000000000000000203e5fbf41c817b48b460e2ac06aff826b4c160f3784d91be47ab02bceeeb5d7f900000000000000000000000000000000000000000000000000000000000001e000000000000000000000000019b8dd424bbee16f091628a415f58cbcd438c4290000000000000000000000000000000000000000000a7a2cba76fcaf571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c80000000000000000000000000000000000000000000000000000000000000280000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000380de2264740f2a2bb5caa89e915318adfa56703b198c9bffd7557ab495f9224d2e0000000000000000000000000000000000000000000000000000000066288363000000000000000000000000000000000000000000000000000000006631bc8700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000a7a2cba76fcaf5710000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006628830f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

console.log(
    "decoded createVestingPool in factory parameters ", parameters
)
/**
 *    struct VestingPool {
        address token0;
        uint256 token0Amount;
        address token1;
        uint256 expectedToken1Amount;
        uint8 poolType;
        bool flexibleAllocation;
        uint256 maxAllocationPerWallet;
        uint96 royaltyRate;


        uint256 startAt;
        uint256 endAt;
        address voucherAddress;

        string baseUrl;
        bytes32 root;
        IVoucher.VestingSchedule[] schedules;
        IVoucher.VestingFee fee;
    }
 */

    console.log(
        parameters[0][10],
        parameters[0][11]
    );
let createPoolParameter = [
    parameters[0][2],
    parameters[0][3],
    parameters[0][4],
    parameters[0][5],
    parameters[0][6],
    parameters[0][7],
    parameters[0][8],
    parameters[0][9],
    parameters[0][14],
    parameters[0][15],
    "0x9869524fd160fe3adDA6218883B6526c0977D3a5",
    parameters[0][12],
    parameters[0][13],
    parameters[0][10],
    parameters[0][11],
];

intf = new Interface(require('../out/VemoVestingPool.sol/VemoVestingPool.json').abi);

encodedDeploy = intf.encodeDeploy([createPoolParameter, "0xD9bd3687a8C129b2A9bE5B3D7A5B691F63A02f1D"] );
// console.log("encodedDeploy ", encodedDeploy);
// decodedDeploy = intf.decodeFunctionData("constructor", "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000d9bd3687a8c129b2a9be5b3d7a5b691f63a02f1d00000000000000000000000019b8dd424bbee16f091628a415f58cbcd438c4290000000000000000000000000000000000000000000a7a2cba76fcaf571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c80000000000000000000000000000000000000000000000000000000066288363000000000000000000000000000000000000000000000000000000006631bc870000000000000000000000009869524fd160fe3adda6218883b6526c0977d3a50000000000000000000000000000000000000000000000000000000000000260de2264740f2a2bb5caa89e915318adfa56703b198c9bffd7557ab495f9224d2e000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000a7a2cba76fcaf5710000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006628830f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");
console.log(
    intf.encodeDeploy([createPoolParameter, "0xD9bd3687a8C129b2A9bE5B3D7A5B691F63A02f1D"] ),
)

//0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000d9bd3687a8c129b2a9be5b3d7a5b691f63a02f1d00000000000000000000000019b8dd424bbee16f091628a415f58cbcd438c4290000000000000000000000000000000000000000000a7a2cba76fcaf571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c80000000000000000000000000000000000000000000000000000000066288363000000000000000000000000000000000000000000000000000000006631bc870000000000000000000000009869524fd160fe3adda6218883b6526c0977d3a50000000000000000000000000000000000000000000000000000000000000260de2264740f2a2bb5caa89e915318adfa56703b198c9bffd7557ab495f9224d2e000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000a7a2cba76fcaf5710000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006628830f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000